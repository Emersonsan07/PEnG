// --- DICIONÁRIO DE TRADUÇÃO (Conteúdo preservado e otimizado) ---
const translations = {
    en: {
        // ... (Mantenha as traduções originais do inglês aqui)
        nav_mission: "Mission", nav_tech: "Technology", nav_invest: "Investors", nav_team: "Team",
        hero_title: "Turning Waste into Clean Energy",
        hero_subtitle: "Advanced technology converting flared natural gas into high-value green fuels.",
        btn_learn: "Our Technology", btn_contact: "Contact Us",
        mission_title: "Our DNA", mission_text: "To accelerate the transition to a circular economy by turning industrial liabilities into clean energy assets.",
        val_1: "Sustainability First", val_2: "Scientific Rigor", val_3: "Transparency",
        process_title: "How It Works", step1_title: "Flare Capture", step1_desc: "Collecting wasted natural gas directly at the wellhead.",
        step2_title: "Catalytic Conversion", step2_desc: "PENG proprietary reactor transforms gas into liquid fuel.",
        step3_title: "Green Fuel", step3_desc: "Ready-to-use synthetic diesel with zero sulfur.",
        tag_research: "For Researchers", tech_title: "Thermodynamic Efficiency",
        tech_card1_title: "Process Integration", tech_card1_desc: "Proprietary catalytic reform processes that minimize energy loss during the gas-to-liquid transition.",
        tech_card2_title: "Carbon Capture", tech_card2_desc: "Built-in modular systems capturing 90% of CO2 emissions directly at the source.",
        tag_invest: "For Investors", invest_title: "Market Opportunity",
        stat_1: "Global Market", stat_2: "Scalability", stat_2_val: "Modular", stat_3: "ROI Target",
        ceo_role: "Founder & CEO", ceo_title: "A Vision from the Lab",
        ceo_quote: "\"We didn't just want to stop flaring; we wanted to make it profitable to stop.\"",
        ceo_bio: "Dr. Gregory Patience spent 15 years in chemical engineering research before founding PENG. Her breakthrough in catalytic efficiency is the core of our patent portfolio.",
        read_bio: "Read Full Bio", team_title: "The Minds Behind PENG", achieve_title: "Achievements & IP",
        pat_1_code: "US Patent 10,234,567", pat_1_desc: "High-efficiency catalytic reactor design for flare gas recovery.",
        paper_1_title: "Nature Energy Journal (2023)", paper_1_desc: "\"Thermodynamic limits of small-scale GTL conversion.\"",
        partners_title: "Supported By & Partners", cta_title: "Join the Energy Revolution", cta_desc: "Stay updated on our latest pilot projects and investment rounds.",
        btn_subscribe: "Subscribe", footer_motto: "Innovating for a cleaner tomorrow.",
        ft_company: "Company", ft_careers: "Careers", ft_legal: "Legal", ft_privacy: "Privacy Policy", ft_terms: "Terms of Use", ft_contact: "Calgary HQ",
        calc_title: "Estimate Your Impact", lbl_volume: "Flare Gas Volume (m³/day)", calc_note: "Move the slider to estimate potential production.",
        res_fuel: "Liters of Green Diesel / Day", res_co2: "Tons of CO2 Saved / Day", res_rev: "Potential Daily Revenue",
        email_placeholder: "email@company.com", msg_success: "Subscribed!", msg_error: "Try Again"
    },
    fr: {
        // ... (Conteúdo original francês)
        nav_mission: "Mission", nav_tech: "Technologie", nav_invest: "Investisseurs", nav_team: "Équipe",
        hero_title: "Transformer les déchets en énergie propre",
        hero_subtitle: "Technologie avancée convertissant le gaz naturel torché en carburants verts à haute valeur.",
        btn_learn: "Notre Technologie", btn_contact: "Contactez-nous",
        mission_title: "Notre ADN", mission_text: "Accélérer la transition vers une économie circulaire en transformant les passifs industriels en actifs énergétiques propres.",
        val_1: "Durabilité d'Abord", val_2: "Rigueur Scientifique", val_3: "Transparence",
        process_title: "Comment ça marche", step1_title: "Captage des Torchères", step1_desc: "Collecte du gaz naturel gaspillé directement à la tête du puits.",
        step2_title: "Conversion Catalytique", step2_desc: "Le réacteur propriétaire PENG transforme le gaz en carburant liquide.",
        step3_title: "Carburant Vert", step3_desc: "Diesel synthétique prêt à l'emploi sans soufre.",
        tag_research: "Pour les Chercheurs", tech_title: "Efficacité Thermodynamique",
        tech_card1_title: "Intégration des Procédés", tech_card1_desc: "Procédés de reformage catalytique propriétaires minimisant la perte d'énergie.",
        tech_card2_title: "Captage du Carbone", tech_card2_desc: "Systèmes modulaires intégrés capturant 90% des émissions de CO2 à la source.",
        tag_invest: "Pour les Investisseurs", invest_title: "Opportunité de Marché",
        stat_1: "Marché Mondial", stat_2: "Évolutivité", stat_2_val: "Modulaire", stat_3: "Cible ROI",
        ceo_role: "Fondatrice & PDG", ceo_title: "Une Vision du Labo",
        ceo_quote: "\"Nous ne voulions pas seulement arrêter le brûlage à la torche; nous voulions rendre cet arrêt rentable.\"",
        ceo_bio: "Dr. Gregory Patience a passé 15 ans en recherche de génie chimique avant de fonder PENG. Sa percée est au cœur de notre portefeuille de brevets.",
        read_bio: "Lire la Bio", team_title: "Les Esprits Derrière PENG", achieve_title: "Réalisations & PI",
        pat_1_code: "Brevet US 10,234,567", pat_1_desc: "Conception de réacteur catalytique à haute efficacité pour la récupération des gaz torchés.",
        paper_1_title: "Revue Nature Energy (2023)", paper_1_desc: "\"Limites thermodynamiques de la conversion GTL à petite échelle.\"",
        partners_title: "Soutenu Par & Partenaires", cta_title: "Rejoignez la Révolution Énergétique", cta_desc: "Restez informé de nos derniers projets pilotes et cycles d'investissement.",
        btn_subscribe: "S'abonner", footer_motto: "Innover pour un demain plus propre.",
        ft_company: "Entreprise", ft_careers: "Carrières", ft_legal: "Légal", ft_privacy: "Politique de Confidentialité", ft_terms: "Conditions d'Utilisation", ft_contact: "Siège Calgary",
        calc_title: "Estimez Votre Impact", lbl_volume: "Volume de Gaz Torché (m³/jour)", calc_note: "Déplacez le curseur pour estimer la production potentielle.",
        res_fuel: "Litres de Diesel Vert / Jour", res_co2: "Tonnes de CO2 Économisées / Jour", res_rev: "Revenus Quotidiens Potentiels",
        email_placeholder: "email@entreprise.com", msg_success: "Inscrit !", msg_error: "Réessayez"
    },
    pt: {
        // ... (Conteúdo original português)
        nav_mission: "Missão", nav_tech: "Tecnologia", nav_invest: "Investidores", nav_team: "Equipe",
        hero_title: "Transformando Desperdício em Energia Limpa",
        hero_subtitle: "Tecnologia avançada que converte gás natural queimado em combustíveis verdes de alto valor.",
        btn_learn: "Nossa Tecnologia", btn_contact: "Fale Conosco",
        mission_title: "Nosso DNA", mission_text: "Acelerar a transição para uma economia circular transformando passivos industriais em ativos de energia limpa.",
        val_1: "Sustentabilidade Primeiro", val_2: "Rigor Científico", val_3: "Transparência",
        process_title: "Como Funciona", step1_title: "Captura de Queima", step1_desc: "Coleta do gás natural desperdiçado diretamente na cabeça do poço.",
        step2_title: "Conversão Catalítica", step2_desc: "O reator proprietário da PENG transforma o gás em combustível líquido.",
        step3_title: "Combustível Verde", step3_desc: "Diesel sintético pronto para uso com zero enxofre.",
        tag_research: "Para Pesquisadores", tech_title: "Eficiência Termodinâmica",
        tech_card1_title: "Integração de Processos", tech_card1_desc: "Processos de reforma catalítica proprietários que minimizam a perda de energia.",
        tech_card2_title: "Captura de Carbono", tech_card2_desc: "Sistemas modulares integrados que capturam 90% das emissões de CO2 na fonte.",
        tag_invest: "Para Investidores", invest_title: "Oportunidade de Mercado",
        stat_1: "Mercado Global", stat_2: "Escalabilidade", stat_2_val: "Modular", stat_3: "Meta de ROI",
        ceo_role: "Fundadora & CEO", ceo_title: "Uma Visão do Laboratório",
        ceo_quote: "\"Não queríamos apenas parar a queima; queríamos tornar lucrativo parar.\"",
        ceo_bio: "O Dr. Gregory Patience passou 15 anos em pesquisa de engenharia química antes de fundar a PENG. Sua descoberta é o núcleo de nosso portfólio.",
        read_bio: "Ler Bio Completa", team_title: "As Mentes por Trás da PENG", achieve_title: "Conquistas & PI",
        pat_1_code: "Patente US 10,234,567", pat_1_desc: "Design de reator catalítico de alta eficiência para recuperação de gás.",
        paper_1_title: "Revista Nature Energy (2023)", paper_1_desc: "\"Limites termodinâmicos da conversão GTL em pequena escala.\"",
        partners_title: "Apoiado Por & Parceiros", cta_title: "Junte-se à Revolução Energética", cta_desc: "Fique atualizado sobre nossos últimos projetos piloto e rodadas de investimento.",
        btn_subscribe: "Inscrever-se", footer_motto: "Inovando para um amanhã mais limpo.",
        ft_company: "Empresa", ft_careers: "Carreiras", ft_legal: "Legal", ft_privacy: "Política de Privacidade", ft_terms: "Termos de Uso", ft_contact: "Sede Calgary",
        calc_title: "Estime o Seu Impacto", lbl_volume: "Volume de Gás Queimado (m³/dia)", calc_note: "Mova o cursor para estimar a produção potencial.",
        res_fuel: "Litros de Diesel Verde / Dia", res_co2: "Toneladas de CO2 Poupadas / Dia", res_rev: "Receita Diária Potencial",
        email_placeholder: "email@empresa.com", msg_success: "Inscrito!", msg_error: "Erro"
    }
};

// --- CONFIGURAÇÃO DE IDIOMA ---
const langSelector = document.getElementById('language-select');
let currentLang = 'en'; // Padrão

function updateLanguage(lang) {
    currentLang = lang;
    const elements = document.querySelectorAll('[data-i18n]');
    
    elements.forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
            element.style.opacity = 0;
            setTimeout(() => {
                element.textContent = translations[lang][key];
                element.style.opacity = 1;
            }, 200);
        }
    });

    const placeholders = document.querySelectorAll('[data-i18n-placeholder]');
    placeholders.forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        if (translations[lang] && translations[lang][key]) {
            element.placeholder = translations[lang][key];
        }
    });
}

// Detecção Automática de Idioma do Navegador
function autoDetectLanguage() {
    const userLang = navigator.language || navigator.userLanguage;
    let targetLang = 'en'; // Padrão (Fallback)

    if (userLang.startsWith('pt')) targetLang = 'pt';
    else if (userLang.startsWith('fr')) targetLang = 'fr';

    // Atualiza o seletor e o conteúdo
    if (langSelector) {
        langSelector.value = targetLang;
        updateLanguage(targetLang);
    }
}

if (langSelector) {
    langSelector.addEventListener('change', (e) => {
        updateLanguage(e.target.value);
    });
}

// Inicia detecção ao carregar
document.addEventListener('DOMContentLoaded', autoDetectLanguage);


// --- ANIMAÇÕES DE SCROLL ---
const observerOptions = { threshold: 0.1, rootMargin: "0px 0px -50px 0px" };
const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('active');
            observer.unobserve(entry.target);
        }
    });
}, observerOptions);

document.querySelectorAll('.scroll-reveal, .card, .step-icon').forEach((el) => {
    el.classList.add('scroll-reveal');
    observer.observe(el);
});

// --- DATA DINÂMICA ---
const yearEl = document.getElementById('year');
if(yearEl) yearEl.textContent = new Date().getFullYear();

// LÓGICA DA NEWSLETTER (FRONTEND)
const newsForm = document.querySelector('.newsletter-form');
if (newsForm) {
    newsForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const emailInput = e.target.querySelector('input[type="email"]');
        const email = emailInput.value;
        const btn = e.target.querySelector('button');
        
        // Validação simples
        if (!email || !email.includes('@')) {
            alert("Email inválido");
            return;
        }

        btn.innerText = "Enviando...";
        btn.disabled = true;

        // AQUI ESTÁ A MUDANÇA: Use o seu link do Formspree
        fetch('https://formspree.io/f/xbdrlajq', { 
            method: 'POST',
            headers: { 'Content-Type': 'application/json' }, // Formspree aceita JSON
            body: JSON.stringify({ email: email })
        })
        .then(response => {
            if (response.ok) {
                btn.innerText = "Inscrito!";
                btn.style.backgroundColor = "#fff";
                btn.style.color = "#00D084";
                emailInput.value = "";
            } else {
                btn.innerText = "Erro";
            }
        })
        .catch(error => {
            console.error('Erro:', error);
            btn.innerText = "Erro";
        })
        .finally(() => {
            setTimeout(() => {
                btn.innerText = "Subscribed"; // Ou o texto original
                btn.style.backgroundColor = "";
                btn.style.color = "";
                btn.disabled = false;
            }, 3000);
        });
    });
}

// --- CALCULADORA ---
function calculateImpact() {
    const volumeInput = document.getElementById('gasInput');
    if(!volumeInput) return;

    const volume = volumeInput.value;
    document.getElementById('gasValue').innerText = Number(volume).toLocaleString(currentLang);

    const fuel = Math.round(volume * 0.52);
    const co2 = (volume * 0.0025).toFixed(1);
    const revenue = Math.round(fuel * 1.6);

    document.getElementById('fuelResult').innerText = fuel.toLocaleString(currentLang);
    document.getElementById('co2Result').innerText = co2.replace('.', ',');
    
    // Formatação de moeda simples baseada no idioma
    let currencyPrefix = "$";
    if (currentLang === 'pt') currencyPrefix = "R$ ";
    else if (currentLang === 'fr') currencyPrefix = "€ "; // Exemplo fictício para FR

    document.getElementById('revResult').innerText = currencyPrefix + revenue.toLocaleString(currentLang);
}

// Export para testes (se ambiente Node)
if (typeof module !== 'undefined') {
    module.exports = { calculateImpact };
}